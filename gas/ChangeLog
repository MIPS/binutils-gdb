2002-02-06  Alexandre Oliva  <aoliva@redhat.com>

	* config/tc-sh.c (md_apply_fix3) <BFD_RELOC_32_PLT_PCREL>: Don't
	assume fixP->fx_subsy is non-NULL.

2002-02-04  Alexandre Oliva  <aoliva@redhat.com>

	* config/tc-sh.c (parse_at): Set arg type of @(expr,pc) to
	A_DISP_PC_ABS, and adjust it by -4.
	(get_specific): Accept A_DISP_PC_ABS where A_DISP_PC is
	expected.
	(build_Mytes): Mark PCRELIMM fix-ups as pc-relative only if
	the operand type is not A_DISP_PC_ABS.

2002-02-04  Hans-Peter Nilsson  <hp@bitrange.com>

	* config/tc-mmix.c (tc_gen_reloc): Don't try and take the value of
	common and weak symbols.  Handle common and weak symbols as
	undefined symbols with regards to GREG handling and merging.
	(mmix_frob_file): Ditto.

2002-02-02  Jason Thorpe  <thorpej@wasabisystems.com>

	* configure.in (hppa-*-netbsd*): New target.
	* configure: Regenerate.
	* config/tc-hppa.h: Also define WARN_COMMENTS if TE_NetBSD.

2002-02-02  Alan Modra  <amodra@bigpond.net.au>

	* config/tc-v850.c: Add missing prototypes amd use old-style
	function definitions.
	(AREA_ZDA, AREA_SDA, AREA_TDA): Delete.
	(sdata_section tdata_section, zdata_section, sbss_section,
	tbss_section, zbss_section, rosdata_section, rozdata_section,
	scommon_section, tcommon_section, zcommon_section,
	call_table_data_section, call_table_text_section): Delete.
	(v850_sdata, v850_tdata, v850_zdata, v850_sbss, v850_tbss,
	v850_zbss, v850_bss, v850_rosdata, v850_rozdata,
	v850_call_table_data, v850_call_table_text): Delete.
	(struct v850_seg_entry): New.
	(v850_seg_table): New.
	(SDATA_SECTION TDATA_SECTION, ZDATA_SECTION, SBSS_SECTION,
	TBSS_SECTION, ZBSS_SECTION, BSS_SECTION, ROSDATA_SECTION,
	ROZDATA_SECTION, SCOMMON_SECTION, TCOMMON_SECTION, ZCOMMON_SECTION,
	CALL_TABLE_DATA_SECTION, CALL_TABLE_TEXT_SECTION): Define.
	(do_v850_seg): New.
	(v850_seg): New.
	(v850_comm): Use do_v850_seg and v850_seg_table.  Simplify
	recording of alignment.
	(md_pseudo_table): Use v850_seg.
	(md_begin): Don't init .call_table_data and .call_table_text here.
	Set v850_seg_table bss entry.

2002-02-01  Hans-Peter Nilsson  <hp@bitrange.com>

	Support on-demand global register allocation by passing on
	base-plus-offset relocs to the linker.
	* config/tc-mmix.c: Tweak and fix typos in comments.
 	(allocate_undefined_gregs_in_linker): New variable.
	(OPTION_LINKER_ALLOCATED_GREGS): New option macro.
	(md_longopts): Add --linker-allocated-gregs.
	(md_parse_option) <case 'x'>: Imply --linker-allocated-gregs.
	<case OPTION_LINKER_ALLOCATED_GREGS>: New.
	(md_show_usage): Update text for -x.  Add text for
	--linker-allocated-gregs.
	(tc_gen_reloc): Derive default value for addend from val and
	baddsy.  Use addsec and bfd_is_abs_section in more places.  Don't
	emit error for BFD_RELOC_MMIX_BASE_PLUS_OFFSET without suitable
	GREG if allocate_undefined_gregs_in_linker.
	* doc/as.texinfo (Overview) <Target MMIX options>: Add
	--linker-allocated-gregs.
	* doc/c-mmix.texi (MMIX-Opts): Add blurb about
	--linker-allocated-gregs.  Mention that it's implied by -x.
	(MMIX-Pseudos) <GREG>: Mention when and how a GREG can be omitted.
	(MMIX-mmixal): Clarify dated comparison and location of MMIXware.

	* config/tc-mmix.h (md_parse_name): Use ISUPPER, not isupper.

2002-02-01  Alan Modra  <amodra@bigpond.net.au>

	* Makefile.am: Run "make dep-am"
	* Makefile.in: Regenerate.

2002-01-31  Ivan Guzvinec  <ivang@opencores.org>

	* config/tc-or32.c: New file.
	* config/tc-or32.h: New file.
	* configure.in: Add support for or32 targets.
	* configure: Regenerate.
	* config/obj-coff.c: Add support for or32 targets.
	* config/obj-coff.h: Add support for or32 targets.
	* Makefile.am: Add support for or32 targets.
	* Makefile.in: Regenerate.
	* NEWS: Mention support for OpenRISC.
	* doc/Makefile.in: Regenerate.
	* po/POTFILES.in: Regenerate.
	* po/gas.pot: Regenerate.

2002-01-30  Richard Sandiford  <rsandifo@redhat.com>

	* config/tc-sh.c (parse_reg): Fix end-of-word check for is, ix, iy
	and mod.

2002-01-29  Chris Demetriou  <cgd@broadcom.com>

	* config/tc-mips.c (tc_gen_reloc): Arrange for
	BFD_RELOC_PCREL_HI16_S relocations to be output relative to
	their LO16 parts, even for ELF.

2002-01-29  Daniel Jacobowitz  <drow@mvista.com>

	* config/tc-i386.c: Protect definitions of true and false
	from redefinition.

2002-01-28  Jakub Jelinek  <jakub@redhat.com>

	* config/obj-elf.c (elf_frob_file_before_adjust): Remove symbols
	made because of .weak, if they are neither defined nor used in any
	way.

2002-01-27  Daniel Jacobowitz  <drow@mvista.com>

	* configure: Regenerated.

2002-01-26  Hans-Peter Nilsson  <hp@bitrange.com>

	* doc/Makefile.am (install): Depend on install-info.
	* doc/Makefile.in: Regenerate.

2002-01-26  Nick Clifton <nick@redhat.com>

	* po/fr.po: Updated version

2002-01-24  Kazu Hirata  <kazu@hxi.com>

	* config/tc-h8300.c (check_operand): Don't print a warning
	when a valid 24-bit address is given to a 16-bit address
	operand.

2002-01-24  Alexandre Oliva  <aoliva@redhat.com>

	* config/tc-sh.c (sh_elf_suffix): Removed.
	(sh_PIC_related_p, sh_check_fixup, sh_cons_fix_new,
	sh_end_of_match, sh_parse_name): New functions.
	(sh_elf_cons): Simplify.
	(parse_exp): Reject misplaced PIC operands.
	(md_undefined_symbol): Simplify.
	(sh_fix_adjustable): Let @GOTOFF be adjusted.
	(md_apply_fix3): Write @PLT and @GOTOFF addends in place.
	(tc_gen_reloc): Move fixp subsy absolute value into addnumber.
	Complain if subsy remains at the end.
	* config/tc-sh.h (sh_parse_name, sh_cons_fix_new): Declare.
	(md_parse_name, TC_CONS_FIX_NEW, O_PIC_reloc): Define.

2002-01-22  Alexandre Oliva  <aoliva@redhat.com>

	* config/tc-mn10300.c (xr_registers): Move `pc'...
	(other_registers): ... here.

2002-01-22  Alan Modra  <amodra@bigpond.net.au>

	* Makefile.am: Run "make dep-am".
	* Makefile.in: Regenerate.
	* gas/po/POTFILES.in: Regenerate.

2002-01-21  DJ Delorie  <dj@redhat.com>

	* config/obj-coff.c (obj_coff_init_stab_section): Make the
	stabstr_name allocation permanent, as it will be referenced from
	the section hash.

2002-01-21  Jason Thorpe  <thorpej@wasabisystems.com>

	* configure.in (ia64-*-netbsd*): New target.
	* configure: Regenerate. 

2002-01-21  Hans-Peter Nilsson  <hp@bitrange.com>

	* doc/as.texinfo (Overview) <Target ARM options>: Add missing {}
	to @dots call.
	<Detailed description, ARM options>: Ditto.
	* doc/c-arm.texi (ARM Options): Ditto.

2002-01-18  Richard Earnshaw  <rearnsha@arm.com>

	* tc-arm.c (do_xsc_mia, do_xsc_mar, do_xsc_mra): Renamed from
	do_mia, do_mar and do_mra respectively.
	(do_mav_*): Renamed from do_c_*.
	(mav_reg_required_here, mav_parse_offset): Renamed from
	cirrus_reg_required_here and cirrus_parse_offset respectively.
	(MAV_MODE?): Renamed from CIRRUS_MODE?.

2002-01-18  Richard Earnshaw  <rearnsha@arm.com>
	    Keith Walker  <keith.walker@arm.com>

	* tc-arm.c (ARM_EXT_V5J, ARM_ARCH_V5TEJ): Define.
	(insns): Add pattern for bxj instruction.
	(do_bxj): New function.
	(arm_cpus): Add arm926ej.
	(arm_archs): Add armv5tej.

2002-01-18  Richard Earnshaw  <rearnsha@arm.com>

	* doc/c-arm.texi: Add new fpe options to list of supported flags.

2002-01-19  Keith Walker  <keith.walker@arm.com>

	* tc-arm.c (arm_fpus): Add fpe2 and fpe3.

2002-01-18  Richard Earnshaw  <rearnsha@arm.com>

	* NEWS: Mention new ARM command-line options and VFP support.

	* config/tc-arm.c (ARM_CEXT_XSCALE): Replaces ARM_EXT_XSCALE.  All 
	uses changed.
	(ARM_CEXT_MAVERICK): Similarly.
	(ARM_ANY): Now means any core instruction.
	(CPU_DEFAULT): Default to ARM_ANY.
	(uses_apcs_26, atcps, support_interwork, uses_apcs_float)
	(pic_code): Declare for all object types.  Make type int.
	(legacy_cpu, legacy_fpu, mcpu_cpu_opt, mcpu_fpu_opt, march_cpu_opt)
	(march_fpu_opt, mfpu_opt): Declare.
	(md_longopts): Tidy up conditional definitions.
	(arm_opts, arm_cpus, arm_archs, arm_fpus, arm_extensions)
	(arm_long_opts): New tables.
	(arm_parse_cpu, arm_parse_arch, arm_parse_fpu): New functions.
	(arm_parse_extension): New function.
	(md_parse_option): Rewrite using new table-driven system.
	(md_show_usage): Use new table-driven system.
	(md_begin): Calculate cpu_variant from command line option data.
	* doc/as.texinfo (ARM ISA options): Docuement new ARM-specific
	command-line options.
	* doc/c-arm.texi: Likewise.

2002-01-18  Andreas Jaeger  <aj@suse.de>

	* as.c (parse_args): Update year.

2002-01-17  Timothy Wall  <twall@alum.mit.edu>

	* config/tc-tic54x.c (encode_address): Add a more informative
	warning about incorrect syntax.

2002-01-17  Nick Clifton  <nickc@cambridge.redhat.com>

	* po/gas.pot: Regenerate.

2002-01-17  Nick Clifton  <nickc@cambridge.redhat.com>

	* macro.c (get_any_string): Add no-c-format comment to prevent
	confusion when translating string.
	* gasp.c (get_any_string): Add no-c-format comment to prevent
	confusion when translating string.

2002-01-16  Thiemo Seufer <seufer@csv.ica.uni-stuttgart.de>
	    Johannes Stezenbach <js@convergence.de>
	* config/tc-mips.c (percent_op): Ensure longer percent_op's are
	matched before the shorter ones.
	(my_getSmallParser): Fix handling of nested parentheses in
	percent_op's. Code cleanup.
	(my_getPercentOp): New function, code from my_getSmallParser.
	(my_getSmallExpression): Fix handling of closing parentheses.
	Code cleanup. Better comments.

2002-01-16  Nick Clifton <nickc@redhat.com>

	po/tr.po: New file: Turkish translation.
	configure.in (LINGUAS): Add "tr".
	configure: Regenerate.

2002-01-15  Richard Earnshaw  <rearnsha@arm.com>

	Support for VFP instructions
	* tc-arm.c (CP_WB_OK, CP_NO_WB): New defines.
	(cp_address_required_here): New argument wb_ok.  When false, do not
	accept write-back forms of addressing.  Change all callers.
	(FPU_VFP_EXT_NONE, FPU_VFP_EXT_V1xD, FPU_VFP_VFP_V1)
	(FPU_VFP_EXT_V2): Define.
	(FPU_ARCH_VFP, FPU_ARCH_VFP_V1xD, FPU_ARCH_VFP_V1, FPU_ARCH_VFP_V2):
	Define in terms of above.
	(vfp_dp_reg_pos, vfp_sp_reg_pos, vfp_ldstm_type): New enums.
	(vfp_reg): New struct.
	(vfp_regs): New array of registers.
	(insns): Add VFP instructions.
	(sn_table): New array of VFP single-precision register names.
	(dn_table): New array of VFP double-precision register names.
	(all_reg_maps): Add the new register tables.
	(arm_reg_type): Add new values for above.  Increase RET_TYPE_MAX.
	(vfp_sp_reg_required_here, vfp_dp_reg_required_here, do_vfp_sp_monadic)
	(do_vfp_dp_monadic, do_vfp_sp_dyadic, do_vfp_dp_dyadic)
	(do_vfp_reg_from_sp, do_vfp_sp_reg2, do_vfp_sp_from_reg)
	(do_vfp_reg_from_dp, do_vfp_reg2_from_dp, do_vfp_dp_from_reg)
	(do_vfp_dp_from_reg2, vfp_psr_parse, vfp_psr_required_here)
	(do_vfp_reg_from_ctrl, do_vfp_ctrl_from_reg, do_vfp_sp_ldst)
	(do_vfp_dp_ldst, vfp_sp_reg_list, vfp_dp_reg_list, vfp_sp_ldstm)
	(vfp_dp_ldstm, do_vfp_sp_ldstmia, do_vfp_sp_ldstmdb, do_vfp_ldstmia)
	(do_vfp_dp_ldstmdb, do_vfp_xp_ldstmia, do_vfp_xp_ldstmdb)
	(do_vfp_sp_compare_z, do_vfp_dp_compare_z, do_vfp_dp_sp_cvt)
	(do_vfp_sp_dp_cvt): New functions.
	(md_begin): Set soft-float flag for appropriate VFP work.
	(md_atof): Handle VFP-format doubles.
	(md_parse_option): Handle VFP command-line options.
	(md_show_usage): Display VFP command-line options.

2002-01-15  Richard Earnshaw  <rearnsha@arm.com>

	* tc-arm.c (md_parse_option): Tidy up setting of cpu_variant for
	various command line options.

2002-01-15  Nick Clifton  <nickc@cambridge.redhat.com>

	* config/tc-xstormy16.c: (xstormy16_fix_adjustable): Do not fix
	vtinherit relocs.
	(xstormy16_md_apply_fix3): Do not return a value.

2002-01-14  Richard Earnshaw  <rearnsha@arm.com>

	* tc-arm.c (md_longopts): On targets that aren't bi-endian, support
	the -EL/-EB option that matches the target's endianness.
	(md_parse_option): Likewise.

2002-01-14  Richard Earnshaw  <rearnsha@arm.com>

	* tc-arm.c (md_longopts): Fix misplaced #endif -- the -oabi option
	is not dependent on ARM_BI_ENDIAN.

2002-01-14  Richard Earnshaw  <rearnsha@arm.com>

	* tc-arm.c (all error messages): Normalize capitalization of messages.

	* tc-arm.h (md_operand): Delete define.
	* tc-arm.c (in_my_get_expression): New static variable.
	(my_get_expression): Set and clear it.
	(md_operand): New function.  If called from my_get_expression
	put the error in inst.error.
	(output_inst): Now takes argument of instruction being assembled.
	Print it out with any error message.
	(do_ldst, do_ldstv4, thumb_load_store): Fault attempt to use a store
	with '=' syntax.
	(end_of_line): Don't update inst.error if it is already set.

2002-01-11  Richard Earnshaw  <rearnsha@arm.com>

	* tc-arm.c ((do_ldst): Fix handling an immediate expression pseudo
	op that can be translated into a mvn instruction.

2002-01-11  Steve Ellcey  <sje@cup.hp.com>

	* gas/config/tc-ia64.h (MD_FLAGS_DEFAULT): New Macro for
	setting default md.flags.
	(SHT_INIT_ARRAY): New elf special section used by HP-UX.
	(SHT_FINI_ARRAY): New elf special section used by HP-UX.
	* gas/config/tc-ia64.c (setup_unwind_header): Add support
	for 32 bit unwind info blocks.
	(generate_unwind_image): Add support for different types
	of unwind images (32 bits and/or big-endian).
	(ia64_init): Use MD_FLAGS_DEFAULT to set md.flags.
	(ia64_target_format): Add support for hpux target formats.
	(ia64_gen_real_reloc_type): Add support for FUNC_IPLT_RELOC.
	(ia64_elf_section_type): Add support for SHT_INIT_ARRAY and
	SHT_FINI_ARRAY elf section types.

2002-01-10  Richard Earnshaw  <rearnsha@arm.com>

	* tc-arm.c (struct reg_entry): Move before prototypes.
	(int_register, cp_register, fp_register): Delete.
	(reg_table): Delete.  Replaced with ...
	(rn_table, cp_table, cn_table, fn_table, mav_mvf_table)
	(mav_mvd_table, mav_mvfx_table, mav_mvdx_table, mav_mvax_table)
	(mav_dspsc_table): ... one table per register set.
	(arm_reg_hsh): Delete.
	(struct reg_map): New structure.
	(all_reg_maps): New array.
	(enum arm_reg_type): New enums.
	(build_reg_hsh): New function.
	(insert_reg_alias): Use hash table passed by caller.  Adjust all
	callers.
	(create_register_alias): New function, split out from ...
	(md_assemble): ... here.
	(md_begin): Build new register hash tables.
	(arm_reg_parse): New argument for the hash table to search.  Adjust all
	callers.
	(arm_reg_parse_any): New function.
	(co_proc_number): Look up the processor number in the processor hash
	table.
	(cirrus_regtype): Delete.
	(cirrus_register, cirrus_mvf_register, cirrus_mvd_register)
	(cirrus_mvfx_register, cirrus_mvdx_register, cirrus_mvax_register)
	(ARM_EXT_MAVERICKsc_register): Delete.
	(do_c_binops_1, do_c_binops_2, do_c_binops_3): Delete.
	(do_c_binops_1[a-o], do_c_binops_2[a-c], do_c_binops_3[a-d]): New
	functions.
	(do_c_triple_4, do_c_triple_5): Delete.
	(do_c_triple_4[ab], do_c_triple_5[a-h]): New functions.
	(do_c_quad_6): Delete.
	(do_c_quad_6[ab]): New functions.
	(do_c_binops, do_c_triple, do_c_quad, do_c_shift, do_c_ldst): Rework
	arguments to use new register parsing methods.
	(cirrus_reg_required_here): Likewise.
	(insns): Reclassify cirrus maverick worker functions.
	(cirrus_valid_reg): Delete.

2002-01-07  Jason Thorpe  <thorpej@wasabisystems.com>

	* configure.in (sh*le): Set cpu_type=sh and endian=little.
	(sh*-*-netbsdelf*): New target.
	* configure: Regenerate.
	* tc-sh.h: Update copyright years.
	(TARGET_FORMAT): Add version for TE_NetBSD.

2002-01-07  Nick Clifton  <nickc@cambridge.redhat.com>

	* read.c (emit_expr): Do not allow 'size' or 'nbytes' to go
	negative.

2002-01-06  Alan Modra  <amodra@bigpond.net.au>

	* config/tc-m68k.h (md_prepare_relax_scan): Rewrite.
	* config/tc-m68k.c (md_relax_table): Add md_prepare_relax_scan comment.

2002-01-05  Daniel Jacobowitz  <drow@mvista.com>

	* tc-mips.c (mips_cprestore_valid): New flag.
	(mips_frame_reg_valid): New flag.
	(macro) [M_JAL_2]: Check both flags.
	[M_JAL_A]: Likewise.
	(s_cprestore): Set mips_cprestore_valid.
	(tc_get_register): If setting mips_frame_reg, set
	mips_frame_reg_valid and clear mips_cprestore_valid.
	(s_mips_ent): Clear both flags.
	(s_mips_end): Clear both flags.

2002-01-05  Alan Modra  <amodra@bigpond.net.au>

	* write.c (write_object_file): Make use of bfd_section_list_remove.
	* config/obj-ecoff.c (ecoff_frob_file): Likewise.
	* config/tc-mmix.c (mmix_frob_file): Likewise.

2002-01-04  Jason Thorpe  <thorpej@wasabisystems.com>

	* configure.in (i386-*-netbsdelf*): Collapse target into...
	(i386-*-netbsd*): ...this.  Add support for x86-64.
	* configure: Regenerated.

2002-01-03  matthew green  <mrg@redhat.com>

	* config/tc-ppc.c (md_parse_option): BookE is not Motorola specific.

2002-01-02  Nick Clifton  <nickc@cambridge.redhat.com>

	* config/tc-m68k.c (md_estimate_size_before_relax): Test for a
	NULL frag link.

For older changes see ChangeLog-0001

Local Variables:
mode: change-log
left-margin: 8
fill-column: 74
version-control: never
End:
